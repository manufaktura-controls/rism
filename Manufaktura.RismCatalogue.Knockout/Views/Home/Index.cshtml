@{
    ViewData["Title"] = "Home Page";
}

@section scripts {
    <script src="~/js/SearchViewModel.min.js"></script>
}

<div class='container-fluid'>
    <div class='row'>
        <div class='col-sm-3'>
        </div>
        <div class="col=sm-9">

            <div data-bind="foreach: results">
                <div data-bind="html: incipitSvg, attr: {'id': 'melody-' + id}"></div>
                <a data-bind="attr: {'id': 'btnPlay-' + id}, click: function() { $parent.player.play(id);}, visible: !$parent.player.isPlaying() || $parent.player.currentMelodyId() != id" class="btn btn-primary">play</a>
                <a class="btn btn-primary" data-bind="attr: {'id': 'btnStop-' + id}, click: $parent.player.stop, , visible: $parent.player.isPlaying() && $parent.player.currentMelodyId() == id" style="display:none"><i class="fa fa-stop-circle"></i> Stop</a>
            </div>
            <i class="fa fa-spinner fa-spin" style="font-size: 30px;" data-bind="visible: isLoading()"></i>
            <a class="btn btn-primary" data-bind="click: getMoreResults">Więcej</a>
        </div>
    </div>
</div>

<script type="text/javascript">
    window.onload = function (e) {
        var vm = new SearchViewModel();
        ko.applyBindings(vm);
        vm.getMoreResults();

        MIDI.loadPlugin({
            soundfontUrl: "./soundfonts/",
            instrument: "acoustic_grand_piano",
            onprogress: function (state, progress) {
                console.log(state, progress);
            },
            onsuccess: function () {
                MIDI.setVolume(0, 127);
            }
        });
    };
</script>